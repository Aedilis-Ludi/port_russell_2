<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>dashboard</title>
</head>
<body>
  <%- include('includes/header') %>

  <main style="max-width:900px; margin:30px auto; font-family:Arial, sans-serif;">
    <h1>Tableau de bord</h1>
    <p>Utilisateur : <%= user ? user.email : 'Non connecté' %></p>
    <p>Date : <%= today %></p>

    <section>
      <h2>Catways</h2>
      <% if (catways.length === 0) { %>
        <p>Aucun catway</p>
      <% } %>
      <% catways.forEach(c => { %>
        <div style="border:1px solid #ccc; padding:10px; margin-bottom:8px;">
          <div><strong>Catway <%= c.catwayNumber %></strong> (<%= c.type %>) - état : <%= c.catwayState %></div>
          <% if (c.currentReservation) { %>
            <div style="margin-top:5px; background:#f0f0f0; padding:5px;">
              Réservé par <strong><%= c.currentReservation.clientName %></strong> pour le bateau <strong><%= c.currentReservation.boatName %></strong>
              du <%= new Date(c.currentReservation.startDate).toLocaleDateString() %> au <%= new Date(c.currentReservation.endDate).toLocaleDateString() %>
            </div>
          <% } else { %>
            <div style="margin-top:5px;">Libre</div>
          <% } %>
          <div style="margin-top:5px;">
            <a href="/catways/<%= c.catwayNumber %>">Voir détails</a>
          </div>
        </div>
      <% }) %>
    </section>
  </main>

  <%- include('includes/footer') %>
</body>
</html>
